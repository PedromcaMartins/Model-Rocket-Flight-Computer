# This file was automatically generated.

[package]
name = "flight-computer"
edition = "2024"
version = "0.0.0"

[lib]
name = "flight_computer"
path = "src/lib.rs"

[lints.rust]
unsafe_code = "forbid"

[lints.clippy]
enum_glob_use = "warn"
pedantic = "warn"
nursery = "warn"
unwrap_used = "warn"

[dependencies]
proto = { version = "*", path = "../proto", features = ["embassy-time"] }
chrono = { version = "^0.4", default-features = false}

embassy-sync = "0.6.2"
embassy-time = "0.4"
embassy-futures = "0.1.2"

defmt = { version = "1.0", optional = true }
log = { version = "0.4", optional = true }
defmt-or-log = "0.2.2"
defmt-or-log-macros = "0.1.2"

embedded-hal = "1.0.0"
embedded-hal-async = "1.0.0"
embedded-io = "0.6.0"
embedded-io-async = "0.6.1"
embedded-storage = "0.3.1"
embedded-hal-bus = { version = "0.3", features = ["async"] }
embedded-sdmmc = { version = "0.9.0", default-features = false }

# Drivers
bmp280-ehal = "0.0.6"
bno055 = "0.4.0"
nmea = { version = "0.7.0", default-features = false, features = ["GGA"] }
switch-hal = "*"

postcard-rpc = "0.11"

static_cell = "2"
thiserror = {version = "2.0.12", default-features = false }
heapless = { version = "0.9.1", default-features = false, features = ["serde"] }
serde-json-core = { version = "0.6", features = ["custom-error-messages"] }
# fugit = "0.3.7"
# micromath = "2.1.0"

[dev-dependencies]
# assert and test logs!
logtest = "2.0"

# replaces embassy-time in tests with mock - assert timers, delays, etc.
embassy-time = { version = "0.4", features = ["mock-driver", "generic-queue-64"] }

# framework async test
async-std = { version = "1.13", features = ["attributes"] }
futures = "0.3.31"
serial_test = "3.2.0"
# prints logs to stdout during tests
test-log = { version = "0.2" }
# improve test complexity
rstest = "=0.24"
# provide random data for tests
rand = { version = "0.9", features = ["std"] }

# required for lib to compile
critical-section = { version = "1.1", features = ["std"] }

# Testing
# proptest = "1.7.0"
# quickcheck = "1.0.3"
# mockall = "0.13.1"

[features]
default = ["log", "impl_embedded", "impl_software"]
log = [
    "dep:log",
    "defmt-or-log/log",
    "embedded-sdmmc/log",
    "proto/log",
]
defmt = [
    "dep:defmt",
    "defmt-or-log/defmt",
    "embassy-sync/defmt",
    "embassy-time/defmt",
    "embassy-time/defmt-timestamp-uptime",
    "embedded-hal/defmt-03",
    "embedded-hal-async/defmt-03",
    "embedded-hal-bus/defmt-03",
    "embedded-io/defmt-03",
    "embedded-io-async/defmt-03",
    "embedded-sdmmc/defmt-log",
    "bno055/defmt-03",
    "nmea/defmt-03",
    "heapless/defmt",
    "serde-json-core/defmt",
    "proto/defmt",
]
impl_embedded = []
impl_software = []